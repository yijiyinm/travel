import{d as J,j as ie,bd as ke,S as ne,u as ue,a8 as q,b3 as Ce,b as de,f as l,a as i,c as x,k as I,Y as B,aA as W,l as N,K as t,_ as pe,be as Se,U as Ve,aW as xe,p as Ee,z as De,n as O,e as ae,aj as u,q as C,A as j,af as Ne,s as Ie,v as $e,bb as L,r as T,a7 as z,o as Ae,w as o,aa as re,aQ as Pe,bc as se,aK as ze,aV as Ue,P as Re}from"./index-5f68169a.js";import{E as Be,g as Fe,f as Je,_ as Oe,a as Te,b as je,c as qe,d as Me,e as We,v as Ye}from"./search-12628e6f.js";import{E as Ke}from"./el-input-number-db4eabe0.js";import{E as Le}from"./el-dialog-031386d7.js";import"./el-tooltip-0dcc7396.js";import"./el-scrollbar-e6c1bf19.js";import{E as X,a as Qe}from"./el-form-item-fa0818c3.js";import{E as Xe}from"./el-date-picker-8ba4186c.js";import{_ as Ge}from"./_plugin-vue_export-helper-c27b6911.js";import"./refs-1985fe1e.js";const G=Symbol("elDescriptions");var M=J({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String},type:{type:String}},setup(){return{descriptions:ie(G,{})}},render(){var _,b,s,E,p,y;const c=ke(this.cell),{border:f,direction:r}=this.descriptions,d=r==="vertical",a=((s=(b=(_=this.cell)==null?void 0:_.children)==null?void 0:b.label)==null?void 0:s.call(b))||c.label,g=(y=(p=(E=this.cell)==null?void 0:E.children)==null?void 0:p.default)==null?void 0:y.call(p),h=c.span,$=c.align?`is-${c.align}`:"",V=c.labelAlign?`is-${c.labelAlign}`:$,S=c.className,P=c.labelClassName,D={width:ne(c.width),minWidth:ne(c.minWidth)},v=ue("descriptions");switch(this.type){case"label":return q(this.tag,{style:D,class:[v.e("cell"),v.e("label"),v.is("bordered-label",f),v.is("vertical-label",d),V,P],colSpan:d?h:1},a);case"content":return q(this.tag,{style:D,class:[v.e("cell"),v.e("content"),v.is("bordered-content",f),v.is("vertical-content",d),$,S],colSpan:d?h:h*2-1},g);default:return q("td",{style:D,class:[v.e("cell"),$],colSpan:h},[Ce(a)?void 0:q("span",{class:[v.e("label"),P]},a),q("span",{class:[v.e("content"),S]},g)])}}});const He=de({row:{type:Array,default:()=>[]}}),Ze={key:1},et=J({name:"ElDescriptionsRow"}),tt=J({...et,props:He,setup(_){const b=ie(G,{});return(s,E)=>l(b).direction==="vertical"?(i(),x(B,{key:0},[I("tr",null,[(i(!0),x(B,null,W(s.row,(p,y)=>(i(),N(l(M),{key:`tr1-${y}`,cell:p,tag:"th",type:"label"},null,8,["cell"]))),128))]),I("tr",null,[(i(!0),x(B,null,W(s.row,(p,y)=>(i(),N(l(M),{key:`tr2-${y}`,cell:p,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(i(),x("tr",Ze,[(i(!0),x(B,null,W(s.row,(p,y)=>(i(),x(B,{key:`tr3-${y}`},[l(b).border?(i(),x(B,{key:0},[t(l(M),{cell:p,tag:"td",type:"label"},null,8,["cell"]),t(l(M),{cell:p,tag:"td",type:"content"},null,8,["cell"])],64)):(i(),N(l(M),{key:1,cell:p,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var lt=pe(tt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/descriptions/src/descriptions-row.vue"]]);const ot=de({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Se,title:{type:String,default:""},extra:{type:String,default:""}}),nt=J({name:"ElDescriptions"}),at=J({...nt,props:ot,setup(_){const b=_,s=ue("descriptions"),E=Ve(),p=xe();Ee(G,b);const y=De(()=>[s.b(),s.m(E.value)]),c=(r,d,a,g=!1)=>(r.props||(r.props={}),d>a&&(r.props.span=a),g&&(r.props.span=d),r),f=()=>{var r;const d=Ne((r=p.default)==null?void 0:r.call(p)).filter(V=>{var S;return((S=V==null?void 0:V.type)==null?void 0:S.name)==="ElDescriptionsItem"}),a=[];let g=[],h=b.column,$=0;return d.forEach((V,S)=>{var P;const D=((P=V.props)==null?void 0:P.span)||1;if(S<d.length-1&&($+=D>h?h:D),S===d.length-1){const v=b.column-$%b.column;g.push(c(V,v,h,!0)),a.push(g);return}D<h?(h-=D,g.push(V)):(g.push(c(V,D,h)),a.push(g),h=b.column,g=[])}),a};return(r,d)=>(i(),x("div",{class:O(l(y))},[r.title||r.extra||r.$slots.title||r.$slots.extra?(i(),x("div",{key:0,class:O(l(s).e("header"))},[I("div",{class:O(l(s).e("title"))},[ae(r.$slots,"title",{},()=>[u(C(r.title),1)])],2),I("div",{class:O(l(s).e("extra"))},[ae(r.$slots,"extra",{},()=>[u(C(r.extra),1)])],2)],2)):j("v-if",!0),I("div",{class:O(l(s).e("body"))},[I("table",{class:O([l(s).e("table"),l(s).is("bordered",r.border)])},[I("tbody",null,[(i(!0),x(B,null,W(f(),(a,g)=>(i(),N(lt,{key:g,row:a},null,8,["row"]))),128))])],2)],2)],2))}});var rt=pe(at,[["__file","/home/runner/work/element-plus/element-plus/packages/components/descriptions/src/description.vue"]]),ce=J({name:"ElDescriptionsItem",props:{label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}});const st=Ie(rt,{DescriptionsItem:ce}),it=$e(ce);function ut(_){return L({url:"/order/getOrderList",method:"post",data:_})}function dt(_){return L({url:"/order/orderRefund",method:"post",data:_})}function pt(_){return L({url:"/order/getOrderDetailWX",method:"post",data:_})}function ct(_){return L({url:"/order/fsxJsByOrderCode",method:"post",data:_})}const mt={class:"app-container"},ft={class:"search"},_t=["src"],bt={style:{"margin-bottom":"20px"}},yt={class:"dialog-footer"},gt={name:"order"},ht=J({...gt,setup(_){const b=T(X);let s=z({}),E=z({});const p=T(X),y=z({visible:!1}),c=T(!1),f=T(),r=T(0),d=z({visible:!1}),a=z({current:1,size:10}),g=z({refundAmount:[{required:!0,message:"请输入",trigger:"blur"},{min:0,max:E.money,message:"退款不能超过剩余金额",trigger:"blur"}]}),h=T(),$={1:"待支付",2:"支付成功",3:"支付失败",4:"已全部退款",5:"部分退款",6:"退款申请中",7:"退款失败",8:"超时取消",9:"已经出行"};function V(m){const n={"1,5,6":"warning","2,4,9":"success","3,7":"error",8:"info"};for(const A in n)if(A.includes(m))return n[A]}function S(){c.value=!0,ut(a).then(({data:m})=>{h.value=m==null?void 0:m.records,r.value=m==null?void 0:m.total}).finally(()=>{c.value=!1})}function P(){b.value.resetFields(),a.current=1,S()}const D=(m,n,A)=>"￥"+A;function v({payPrice:m,refundAmount:n,orderCode:A}){E.money=(m*100-n*100)/100,y.visible=!0,s.orderCode=A,s.refundAmount=null}function me(){p.value.validate(m=>{m&&dt({orderCode:s.orderCode,refundAmount:s.refundAmount}).then(()=>{se.success("操作成功"),s=z({}),Y(),P()})})}function fe(m){f.value={},d.visible=!0,d.title="详情",pt({orderCode:m}).then(n=>{f.value=n==null?void 0:n.data})}function Y(){d.visible=!1,y.visible=!1,E=z({}),s=z({}),p.value.clearValidate()}Ae(()=>{S()});function _e({orderCode:m}){ze.confirm("确认结算该分销商订单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ct({orderCode:m}).then(()=>{se.success("结算成功"),P()}).finally()})}return(m,n)=>{const A=Ue,U=Qe,Q=Fe,H=Je,be=Xe,ye=Oe,F=Re,ge=Te,Z=X,w=je,K=qe,ee=Me,he=We,ve=Be,R=it,te=st,le=Le,we=Ke,oe=Ye;return i(),x("div",mt,[I("div",ft,[t(Z,{ref_key:"queryFormRef",ref:b,model:l(a),inline:!0},{default:o(()=>[t(U,{prop:"orderCode",label:"订单编号"},{default:o(()=>[t(A,{modelValue:l(a).orderCode,"onUpdate:modelValue":n[0]||(n[0]=e=>l(a).orderCode=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),t(U,{label:"订单状态",prop:"orderStatus"},{default:o(()=>[t(H,{modelValue:l(a).orderStatus,"onUpdate:modelValue":n[1]||(n[1]=e=>l(a).orderStatus=e),placeholder:"订单状态",clearable:""},{default:o(()=>[(i(),x(B,null,W($,(e,k)=>t(Q,{key:k,label:e,value:k},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(U,{label:"是否分销商",prop:"distributionIs"},{default:o(()=>[t(H,{modelValue:l(a).distributionIs,"onUpdate:modelValue":n[2]||(n[2]=e=>l(a).distributionIs=e),placeholder:"是否分销商",clearable:""},{default:o(()=>[t(Q,{value:!0,label:"是"}),t(Q,{value:!1,label:"否"})]),_:1},8,["modelValue"])]),_:1}),t(U,{prop:"fxsCode",label:"分销商编码"},{default:o(()=>[t(A,{modelValue:l(a).fxsCode,"onUpdate:modelValue":n[3]||(n[3]=e=>l(a).fxsCode=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),t(U,{prop:"fxsPhone",label:"分销商手机号"},{default:o(()=>[t(A,{modelValue:l(a).fxsPhone,"onUpdate:modelValue":n[4]||(n[4]=e=>l(a).fxsPhone=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),t(U,{prop:"month",label:"日期"},{default:o(()=>[t(be,{modelValue:l(a).month,"onUpdate:modelValue":n[5]||(n[5]=e=>l(a).month=e),type:"month",placeholder:"请选择","value-format":"YYYY-MM"},null,8,["modelValue"])]),_:1}),t(U,null,{default:o(()=>[t(F,{type:"primary",onClick:S},{default:o(()=>[t(ye),u("搜索")]),_:1}),t(F,{onClick:P},{default:o(()=>[t(ge),u("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),t(ve,{shadow:"never"},{default:o(()=>[re((i(),N(ee,{ref:"dataTableRef",data:l(h),"highlight-current-row":"",selectable:"false",border:""},{default:o(()=>[t(w,{label:"订单编码",prop:"orderCode",width:"150"}),t(w,{label:"商品名称","min-width":"100","max-width":"200"},{default:o(e=>[I("img",{src:e.row.mainUrl},null,8,_t),u(" "+C(e.row.productName),1)]),_:1}),t(w,{label:"状态",width:"100"},{default:o(e=>[t(K,{type:V(e.row.orderStatus)},{default:o(()=>[u(C($[e.row.orderStatus]),1)]),_:2},1032,["type"])]),_:1}),t(w,{label:"出行时间",prop:"chuXingDate","min-width":"100"}),t(w,{label:"数量",prop:"num","min-width":"100"}),t(w,{label:"支付金额",prop:"payPrice","min-width":"100",formatter:D}),t(w,{label:"退款金额",prop:"refundAmount","min-width":"100"}),t(w,{label:"下单时间",prop:"createDate","min-width":"100"}),t(w,{label:"分销商编码",prop:"fxsCode","min-width":"100"}),t(w,{label:"分销商手机号",prop:"fxsPhone","min-width":"100"}),t(w,{label:"分销商结算",prop:"fxsJsName","min-width":"100"},{default:o(e=>[e.row.fxsJs==1?(i(),N(K,{key:0,type:"success"},{default:o(()=>[u(C(e.row.fxsJsName),1)]),_:2},1024)):j("",!0),e.row.fxsJs==2?(i(),N(K,{key:1,type:"warning"},{default:o(()=>[u(C(e.row.fxsJsName),1)]),_:2},1024)):j("",!0)]),_:1}),t(w,{fixed:"right",label:"操作",width:"220"},{default:o(e=>[t(F,{type:"primary",size:"small",link:"",onClick:k=>fe(e.row.orderCode)},{default:o(()=>[u(" 详情 ")]),_:2},1032,["onClick"]),"2,5,7".includes(e.row.orderStatus)?(i(),N(F,{key:0,type:"primary",size:"small",link:"",onClick:k=>v(e.row)},{default:o(()=>[u(" 退款 ")]),_:2},1032,["onClick"])):j("",!0),e.row.fxsJs==2?(i(),N(F,{key:1,type:"primary",size:"small",link:"",onClick:k=>_e(e.row)},{default:o(()=>[u(" 分销商结算 ")]),_:2},1032,["onClick"])):j("",!0)]),_:1})]),_:1},8,["data"])),[[oe,l(c)]]),l(r)>0?(i(),N(he,{key:0,total:l(r),"onUpdate:total":n[6]||(n[6]=e=>Pe(r)?r.value=e:null),page:l(a).current,"onUpdate:page":n[7]||(n[7]=e=>l(a).current=e),limit:l(a).size,"onUpdate:limit":n[8]||(n[8]=e=>l(a).size=e),onPagination:S},null,8,["total","page","limit"])):j("",!0)]),_:1}),t(le,{title:l(d).title,modelValue:l(d).visible,"onUpdate:modelValue":n[9]||(n[9]=e=>l(d).visible=e),width:"1000px",onClose:Y},{default:o(()=>[t(te,{title:"订单详情",column:3},{default:o(()=>[t(R,{label:"订单状态"},{default:o(()=>{var e;return[t(K,{type:V((e=l(f))==null?void 0:e.orderStatus)},{default:o(()=>{var k;return[u(C($[(k=l(f))==null?void 0:k.orderStatus]),1)]}),_:1},8,["type"])]}),_:1}),t(R,{label:"产品数量"},{default:o(()=>{var e;return[u(C((e=l(f))==null?void 0:e.num),1)]}),_:1}),t(R,{label:"订单金额"},{default:o(()=>{var e;return[u(C((e=l(f))==null?void 0:e.payPrice),1)]}),_:1}),t(R,{label:"退款金额"},{default:o(()=>{var e;return[u(C(((e=l(f))==null?void 0:e.refundAmount)||"-"),1)]}),_:1}),t(R,{label:"商品Code"},{default:o(()=>{var e,k;return[u(C((k=(e=l(f))==null?void 0:e.productInfo)==null?void 0:k.productCode),1)]}),_:1}),t(R,{label:"商品名称"},{default:o(()=>{var e,k;return[u(C((k=(e=l(f))==null?void 0:e.productInfo)==null?void 0:k.productName),1)]}),_:1}),t(R,{label:"出行时间"},{default:o(()=>{var e;return[u(C((e=l(f))==null?void 0:e.chuXingDate),1)]}),_:1})]),_:1}),t(te,{title:"出行人信息"},{default:o(()=>[t(R,{label:"出行人信息",span:4},{default:o(()=>{var e;return[re((i(),N(ee,{ref:"dataTableRef",data:(e=l(f))==null?void 0:e.touristInfo,"highlight-current-row":"",selectable:"false"},{default:o(()=>[t(w,{label:"姓名",prop:"name"}),t(w,{label:"手机号",prop:"phone"}),t(w,{label:"身份证号",prop:"cardId"})]),_:1},8,["data"])),[[oe,l(c)]])]}),_:1})]),_:1})]),_:1},8,["title","modelValue"]),t(le,{title:"退款",modelValue:l(y).visible,"onUpdate:modelValue":n[11]||(n[11]=e=>l(y).visible=e),width:"350px",onClose:Y},{footer:o(()=>[I("div",yt,[t(F,{type:"primary",onClick:me},{default:o(()=>[u("确定")]),_:1}),t(F,{onClick:Y},{default:o(()=>[u("取消")]),_:1})])]),default:o(()=>[t(Z,{model:l(s),ref_key:"refundFormRef",ref:p,"label-width":"80px","label-position":"top",rules:l(g)},{default:o(()=>[I("div",bt,"剩余金额:"+C(l(E).money),1),t(U,{label:"退款金额",prop:"refundAmount"},{default:o(()=>[t(we,{modelValue:l(s).refundAmount,"onUpdate:modelValue":n[10]||(n[10]=e=>l(s).refundAmount=e),"controls-position":"right",min:0,max:l(E).money,placeholder:"请输入",style:{width:"230px"}},null,8,["modelValue","max"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});const It=Ge(ht,[["__scopeId","data-v-a3dcb67e"]]);export{It as default};
